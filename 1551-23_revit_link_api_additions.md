---
author: Jeremy Tammik
optimization_date: '2025-12-11T11:24:10.442993'
original_url: https://thebuildingcoder.typepad.com/blog/1551_whats_new_2018.html
parent_post: 1551_whats_new_2018.md
part_number: '23'
part_total: '23'
post_number: '1551'
series: geometry
slug: whats_new_2018_revit_link_api_additions
source_file: 1551_whats_new_2018.md
tags:
- doors
- elements
- family
- geometry
- levels
- parameters
- python
- references
- revit-api
- rooms
- schedules
- selection
- sheets
- transactions
- views
- walls
title: API Changes - Revit Link API additions
word_count: 3643
---

### Revit Link API additions

The new method:

* static RevitLinkInstance.Create(ImportPlacement placement)

creates a new instance of a linked Revit project (RevitLinkType). Instances will be placed origin-to-origin or by shared coordinates according to the input placement type.

## Link API additionsExternal Resource framework additions IExternalResourceServer can now provide CAD format links, DWF markups, and IFC links. The following new values have been added to ExternalResourceType.BuiltInExternalResourceTypes: * CADLink * DWFMarkup * IFCLink CADLinkType additions Several new methods have been added to CADLinkType as part of external resource framework enhancements: * CADLinkType.Reload() – Reloads a CADLinkType from its current location. * CADLinkType.Reload(CADLinkOptions options) – Reloads a CADLinkType from its current location, including options to control graphic overrides. * CADLinkType.LoadFrom(String fileName) – Reloads a CADLinkType from a file on disk. * CADLinkType.LoadFrom(ExternalResourceReference reference) – Reloads a CADLinkType from an external resource server. ImportInstance additions Several new methods have been added to create ImportInstance elements, either from an existing link type or a new link type: * ImportInstance.Create(DWGImportOptions options, String fileName) – Creates a new DWG or DXF type and instance from a file on disk. * ImportInstance.Create(DWGImportOptions options, ExternalResourceReference reference) – Creates a new DWG or DXF type and instance from an external resource location. * ImportInstance.Create(ElementId typeId) – Creates a new DWG or DXF instance from an existing CADLinkType. Methods have also been added to create DGN, SAT, and SKP links from external resource locations. IFC Link API additions The method: * RevitLinkType.UpdateFromIFC() now has a new version that allows for an ExternalResourceReference to specify the IFC file name, instead of a string. Workshared operation progress changed events Subscribe to the Autodesk.Revit.ApplicationServices.Application.WorksharedOperationProgressChanged event to be notified when progress has changed during Collaboration for Revit's synchronizing. This event consists of several phases. Different event arguments are used during each phase. WorksharedOperationProgressChangedEventArgs The new class: * Autodesk.Revit.DB.Events.WorksharedOperationProgressChangedEventArgs provides a base class for event arguments for worksharing-based progress events. DocumentSaveToLocalProgressChangedEventArgs The new class: * Autodesk.Revit.DB.Events.DocumentSaveToLocalProgressChangedEventArgs provides information during the save to local phase of the DocumentSynchronizingWithCentralProgressChanged event. It has the following properties: * DocumentSaveToLocalProgressChangedEventArgs.Location – Full path of the central model which is to be synchronized. * DocumentSaveToLocalProgressChangedEventArgs.Status – Gets the API event status, which reflects the current operation execution status. * DocumentSaveToLocalProgressChangedEventArgs.BeforeSaveToCentral – True if the "save to local" operation is occurring before "save to central"; false if after. * DocumentSaveToLocalProgressChangedEventArgs.FinishedStreams – The number of streams finished since the last time this event was raised. * DocumentSaveToLocalProgressChangedEventArgs.TotalStreams – The total expected number of streams to save to local. * DocumentSaveToLocalProgressChangedEventArgs.SaveToLocalFinished – Indicates if the current "save to local" operation has finished. DataTransferProgressChangedEventArgs The new class: * Autodesk.Revit.DB.Events.DataTransferProgressChangedEventArgs provides information during the data transferring phase of the WorksharedOperationProgressChanged event. Generally, it is not used directly because It is the base class of Autodesk.Revit.DB.Events.DocumentReloadLatestProgressChangedEventArgs, Autodesk.Revit.DB.Events.DocumentSaveToCentralProgressChangedEventArgs and Autodesk.Revit.DB.Events.CreateRelatedFileProgressChangedEventArgs It has the following properties: * DataTransferProgressChangedEventArgs.Location – Full path of the central model which is to be synchronized. * DataTransferProgressChangedEventArgs.Status – Gets the API event status, which reflects the current operation execution status. * DataTransferProgressChangedEventArgs.TransferMode – Gets the transfer mode of this data transfer progress. It is Undefined or Download or Upload; * DataTransferProgressChangedEventArgs.Speed – Gets data transfer speed(bytes/second). * DataTransferProgressChangedEventArgs.FinishedSize – Gets downloaded or uploaded data size, in bytes, since the last time this event was raised. * DataTransferProgressChangedEventArgs.TotalSize – Total expected data size to download, in bytes. DocumentReloadLatestProgressChangedEventArgs The new class: * Autodesk.Revit.DB.Events.DocumentReloadLatestProgressChangedEventArgs provides information during the reload latest phase of the DocumentSynchronizingWithCentralProgressChanged event. It has the following properties: * DocumentReloadLatestProgressChangedEventArgs.Location – The full path of the central model which is to be synchronized. * DocumentReloadLatestProgressChangedEventArgs.Status – Gets API event status, reflecting the current operation execution status. * DocumentReloadLatestProgressChangedEventArgs.TransferMode – Returns DataTransferMode.Download. * DocumentReloadLatestProgressChangedEventArgs.RetryTimes – The number of times Revit has tried to Reload Latest. Its value is '0' at the first time. * DocumentReloadLatestProgressChangedEventArgs.Speed – Download speed(bytes/second) in this event. * DocumentReloadLatestProgressChangedEventArgs.FinishedSize – The downloaded data size, in bytes, since the last time this event was raised. * DocumentReloadLatestProgressChangedEventArgs.TotalSize – Total expected data size to download, in bytes. * DocumentReloadLatestProgressChangedEventArgs.IsMerging – Indicates if Revit is merging downloaded data. * DocumentReloadLatestProgressChangedEventArgs.ReloadLatestFinished – Indicates if current 'reload latest' progress is finished or not. DocumentSaveToCentralProgressChangedEventArgs The new class: * Autodesk.Revit.DB.Events.DocumentSaveToCentralProgressChangedEventArgs provides information during the save to central phase of the DocumentSynchronizingWithCentralProgressChanged event. It has the following properties: * DocumentSaveToCentralProgressChangedEventArgs.Location – Full path of the central model which is to be synchronized. * DocumentSaveToCentralProgressChangedEventArgs.Status – Gets API event status, reflecting the current operation execution status. * DocumentSaveToCentralProgressChangedEventArgs.TransferMode – Returns DataTransferMode.Upload. * DocumentSaveToCentralProgressChangedEventArgs.RetryTimes – The number of times Revit has tried to Save to Central." Its value is '0' at the first time. * DocumentSaveToCentralProgressChangedEventArgs.Speed – Upload speed(bytes/second) of saving to central. * DocumentSaveToCentralProgressChangedEventArgs.FinishedSize – The uploaded data size, in bytes, since the last time this event was raised. * DocumentSaveToCentralProgressChangedEventArgs.TotalSize – Total expected uploaded data size to save to central, in bytes. * DocumentSaveToCentralProgressChangedEventArgs.SaveToCentralFinished – Indicates if current 'save to central' is finished or not. * DocumentSaveToCentralProgressChangedEventArgs.FailureDueToConflicts – Indicates the 'save to central' failure is caused by submission, that is because another user finished saving to central first. CreateRelatedFileProgressChangedEventArgs The new class: * Autodesk.Revit.DB.Events.CreateRelatedFileProgressChangedEventArgs provides information about the creation of related files when Collaboration for Revit models are being opened. It has the following properties: * CreateRelatedFileProgressChangedEventArgs.Location – Full path of the model which is to be created related file. * CreateRelatedFileProgressChangedEventArgs.Status – Gets API event status, reflecting the current operation execution status. * CreateRelatedFileProgressChangedEventArgs.TransferMode – Returns DataTransferMode.Download. * CreateRelatedFileProgressChangedEventArgs.CreatingCloudSharedLocal – Indicates if it is creating cloud shared local model. * CreateRelatedFileProgressChangedEventArgs.DownloadFinished – Indicates if all data downloads are finished or not. * CreateRelatedFileProgressChangedEventArgs.Speed – Download speed(bytes/second) in this event. * CreateRelatedFileProgressChangedEventArgs.FinishedSize – The downloaded data size, in bytes, since the last time this event was raised. * CreateRelatedFileProgressChangedEventArgs.TotalSize – Total expected data size to download, in bytes. * CreateRelatedFileProgressChangedEventArgs.FullDownload – Indicates if download the full data of the document, which will take longer than subsequent downloads. Events related to linked resources Subscribe to the events: * Autodesk.Revit.ApplicationServices.Application.LinkedResourceOpening * Autodesk.Revit.ApplicationServices.ControlledApplication.LinkedResourceOpening * Autodesk.Revit.ApplicationServices.Application.LinkedResourceOpened * Autodesk.Revit.ApplicationServices.ControlledApplication.LinkedResourceOpened to be notified when Revit is just about to open, or has just opened, a linked resource. This event supports linked resources of the following types: Revit; IFC; CAD (DWG, DXF, DGN, SAT). This event will not be raised if there are no updates for linked CAD or IFC resources. The linked resource cannot be modified during these events. LinkedResourceOpeningEventArgs The new class: * Autodesk.Revit.DB.Events.LinkedResourceOpeningEventArgs provides information when Revit is just about to open a linked resource. It has the following properties: * LinkedResourceOpeningEventArgs.ResourceType – Linked resource type. * LinkedResourceOpeningEventArgs.LinkedResourcePathName – The linked resource name to open. LinkedResourceOpenedEventArgs The new class: * Autodesk.Revit.DB.Events.LinkedResourceOpenedEventArgs provides information when Revit finishes opening a linked resource. It has the following properties: * LinkedResourceOpenedEventArgs.ResourceType – Linked resource type. * LinkedResourceOpenedEventArgs.LinkedResourcePathName – Opened linked resource name. Events related to parallel View Export When exporting multiple views to DWF or DWFx format, Revit uses background processes to compute the exported output of several views in parallel. Two events are now available on the Application class to receive progress updates during a parallel export operation: * Application.ViewExporting – This event is raised when Revit is just about to export a view of the document. * Application.ViewExported – This event is raised immediately after Revit has finished exporting a view of the document. These two events are raised only during accelerated export jobs, in which views are exported in parallel using a background process. Accelerated export only occurs when exporting to DWF formats and not combining views into a single file. DWG export API additions The new enumerated value: * ExportColorMode.TrueColorPerView specified an export where all colors from the Revit project will be exported as 24-bit RGB values as specified in view (where ExportColorMode.TrueColor indicates that all colors from the Revit project will be exported as 24-bit RGB values as specified in object styles) The new properties: * ACADExportOptions.UseHatchBackgroundColor * ACADExportOptions.HatchBackgroundColor allow assignment of a color that will be set as hatch background color on the exported hatch. ExportDWGSettings API additions Two new methods have been added to ExportDWGSettings: * ExportDWGSettings.FindByName() – Returns the pre-defined DWG export settings in the given document with the specified name. * ExportDWGSettings.GetActivePredefinedSettings() – Returns the active DWG export settings in the given document. Note that these functions cannot return in-session settings. To access the in-session settings, save them with a name. Part API additions The new methods: * Part.ResetFaceOffset() * Part.GetFaceOffset() provide further capabilities to access and manipulate the offset applied to a given face of a Part element. Freeform Rebar API additions The new methods: * Rebar.CreateFreeForm(Document, RebarBarType, Element, IList>, out RebarFreeFormValidationResult) * Rebar.CreateFreeForm(Document, RebarBarType, Element, IList, out RebarFreeFormValidationResult) Create a freeform rebar instance where bars are created along the path of the input curves. Constraints cannot later be added to this rebar. Freeform rebar instances have properties accessible from the RebarFreeFormAccessor class, which can be obtained from: * Rebar.GetFreeFormAccessor() The new members of this accessor class allow you to change the bar curves only for unconstrained rebar: * RebarFreeFormAccessor.SetCurves() * RebarFreeFormAccessor.IsUnconstrained() They also provide access to layout, distribution path and hook properties of the rebar, if applicable: * RebarFreeFormAccessor.SetLayoutAsSingle() * RebarFreeFormAccessor.SetLayoutAsNumberWithSpacing() * RebarFreeFormAccessor.SetLayoutAsFixedNumber() * RebarFreeFormAccessor.SetLayoutAsMaximumSpacing() * RebarFreeFormAccessor.SetLayoutAsMinimumClearSpacing() * RebarFreeFormAccessor.GetCustomDistributionPath() * RebarFreeFormAccessor.SetHookPlaneNormalForBarIdx() * RebarFreeFormAccessor.GetHookPlaneNormalForBarIdx() * RebarFreeFormAccessor.SetHookOrientationAngle() * RebarFreeFormAccessor.GetHookOrientationAngle() Custom Service for Freeform Rebar Definition The new interface class: * IRebarUpdateServer represents an interface that can be overridden to drive the generation and update of freeform rebar geometry. The interface features several methods: * IRebarUpdateServer.GetCustomHandles() – This method should define all handles that the Rebar instance will have. This method is called when the Rebar is created. * IRebarUpdateServer.GetCustomHandleName() – This function should return the user-visible name of the handle. This function is called during an editing operation for the Rebar constraints when the mouse is over a handle * IRebarUpdateServer.GenerateCurves() – This function should calculate the bar geometry. * IRebarUpdateServer.TrimExtendCurves() – This function should calculate the trim and/or extension of the curves that were obtained from calling GenerateCurves(), as well as to assign new constraints for the start and end handles. * IRebarUpdateServer.GetHandlesPosition() – This function is supposed to provide the positions of handles defined in GetCustomHandles(). These positions will be shown on screen when the bar constraints are edited. If a position for a handle isn't provided, that handle will not be represented on screen while edit constraints. The interfaces methods each provide an input argument which carries data needed for the calculation, as well as the results. These new argument classes are: * RebarHandlesData * RebarHandleNameData * RebarUpdateCurvesData * RebarCurvesData * RebarTrimExtendData * RebarHandlePositionData You can programmatically create a freeform Rebar whose geometry and constraints are governed by the external service using: * Rebar.Create(Document, GUID, RebarBarType, Element) You can convert a FreeForm rebar governed by an external service to an unconstrained element using: * RebarFreeFormAccessor.DisconnectFromServer() In order to access and modify constraints associated to any custom handles associated to the service-driven freeform Rebar, you may use the members of the RebarConstrainedHandle class: * RebarConstrainedHandle.IsCustomHandle() * RebarConstrainedHandle.HandleName * RebarConstrainedHandle.GetCustomHandleTag() and use the new members of RebarConstraint and RebarConstraintsManager: * RebarConstraint.Create(RebarConstrainedHandle, IList, bool, double) * RebarConstraint.ReplaceReferenceTargets() * RebarConstraint.NumberOfTargets * RebarConstraint.GetTargetElement() * RebarConstraint.GetRebarConstraintTargetHostFaceType() * RebarConstraint.GetTargetHostFaceAndTransform() * RebarConstraint.GetTargetCoverType() * RebarConstraint.GetTargetHostFaceReference() * RebarConstraint.GetCustomHandleTag() * RebarConstraintsManager.GetAllHandles() * RebarConstraintsManager.AllowConstraintTargets() HVACSpaceType and Space air ventilation API The following new properties have been added to Autodesk.Revit.DB.Space: * Space.SpaceTypeId – Gets or sets the Space type element of the Space. * Space.OutdoorAirPerPerson – Gets the specified outdoor air per person, in cubic feet per second. * Space.OutdoorAirPerArea – Gets the specified outdoor air per area, in feet per second. * Space.AirChangesPerHour – Gets the specified air changes per hour of the space. * Space.OutdoorAirflow – Gets the outdoor airflow of the Space, in cubic feet per second. * Space.OutdoorAirFlowStandard – Gets the outdoor air flow standard of the space. Energy Analysis API additions Several new classes have been added to allow better control over spaces when doing energy analysis. The new class: * Autodesk.Revit.DB.Analysis.HVACLoadType is the base class for HVACLoadSpaceType and HVACLoadBuildingType. It has the following properties: * Autodesk.Revit.DB.Analysis.HVACLoadType.AirChangesPerHour – The air changes per hour. * Autodesk.Revit.DB.Analysis.HVACLoadType.AreaPerPerson – The area per person. * Autodesk.Revit.DB.Analysis.HVACLoadType.LatentHeatGainPerPerson – The latent heat gain per person. * Autodesk.Revit.DB.Analysis.HVACLoadType.LightingLoadDensity – The lighting load density. * Autodesk.Revit.DB.Analysis.HVACLoadType.OutdoorAirPerArea – The outdoor air per area. * Autodesk.Revit.DB.Analysis.HVACLoadType.OutdoorAirPerPerson – The outdoor air per person. * Autodesk.Revit.DB.Analysis.HVACLoadType.OutdoorAirFlowStandard-The outdoor airflow standard. * Autodesk.Revit.DB.Analysis.HVACLoadType.PlenumLighting – The percentage of plenum lighting contribution. * Autodesk.Revit.DB.Analysis.HVACLoadType.PowerLoadDensity – The power load density. * Autodesk.Revit.DB.Analysis.HVACLoadType.SensibleHeatGainPerPerson – The sensible heat gain per person. The new class: * Autodesk.Revit.DB.Analysis.HVACLoadSpaceType allows users to set the usage type associated with the space, such as 'Dining Area' or 'Lobby'. It has the following methods and properties: * Autodesk.Revit.DB.Analysis.HVACLoadSpaceType.Create() * Autodesk.Revit.DB.Analysis.HVACLoadSpaceType.IsNameUnique(String) * Autodesk.Revit.DB.Analysis.HVACLoadSpaceType.IsNameUnique(Document, String) * Autodesk.Revit.DB.Analysis.HVACLoadSpaceType.IsPlenum * Autodesk.Revit.DB.Analysis.HVACLoadSpaceType.SpaceTypeName The new class: * Autodesk.Revit.DB.Analysis.HVACLoadBuildingType allows users to set the energy analysis usage type associated with a building, such as 'Museum' or 'Office'. It has the following methods and properties: * Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.Create() * Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.IsNameUnique(String) * Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.IsNameUnique(Document, String) * Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.BuildingTypeName * Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.OpeningTime * Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.ClosingTime * Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.IsValidTime() – Checks if the string can be parsed to a valid time for opening time and closing time. A valid string can be "16:30" or "4:30 PM". * Autodesk.Revit.DB.Analysis.HVACLoadBuildingType.UnoccupiedCoolingSetPoint – The unoccupied cooling set point of the building type with unit Kelvin (K). The new properties: * Autodesk.Revit.DB.Analysis.MassZone.SpaceTypeId * Autodesk.Revit.DB.Mechanical.Space.SpaceTypeId allow users to set the energy analysis type associated with a space or mass zone. Note that these classes are not ElementTypes. They represent properties of a space or building when doing energy analysis, and do not have instances. Electrical API additionsElectrical Circuit Path API The new API members: * ElectricalSystem.PathOffset * ElectricalSystem.HasPathOffset * ElectricalSystem.HasCustomCircuitPath * ElectricalSystem.CircuitPathMode * ElectricalSystem.GetCircuitPath() * ElectricalSystem.SetCircuitPath() * ElectricalSystem.IsCircuitPathValid() support different options and operations related to electrical circuit paths. PanelScheduleView API The following new methods handle space or spare circuit operations: * PanelScheduleView.AddSpace() – Add a space at specific cell. * PanelScheduleView.AddSpare() – Add a spare at specific cell. * PanelScheduleView.RemoveSpace() – Remove a space at specific cell. * PanelScheduleView.RemoveSpare() – Remove a spare at specific cell. MEPAnalyticalConnection API additions Two new classes have been added to allow API users to create analytical connections between elements. The behavior is the same as in Revit's UI. The new class: * MEPAnalyticalConnection represents an analytical element that connected mechanical equipment to a piping network. The analytical connection can be used to create a network even if no real pipes are placed yet. It enables the fast establishment of a piping network to analyze the flow and pressure, especially at the early stage of the design process. It has the following methods: * MEPAnalyticalConnection.Create() – Creates a new analytical connection between two connectors. * MEPAnalyticalConnection.CreateMultipleConnections() – Creates new analytical connections between the equipment connector and the nearest point on the piping network. * MEPAnalyticalConnection.GetFlow() – Returns the up-to-date flow value. If the network is asynchronously calculated, this method would wait until the calculation is completed. The new class: * MEPAnalyticalConnectionType is the type element of an MEPAnalyticalConnection. Its pressure loss value is included in the network critical path calculation. It has the following methods and properties: * MEPAnalyticalConnectionType.Create() – Creates a new analytical connection type with the specified name. * MEPAnalyticalConnectionType.IsNameUnused() – Checks if the name is already used. * MEPAnalyticalConnectionType.GetAllTypes() – Returns all types in the document. * MEPAnalyticalConnectionType.PressureLoss – The pressure loss associated with this type. This property is writable. The new property: * Autodesk.Revit.DB.Plumbing.PipeSettings.AnalysisForClosedLoopHydronicPipingNetworks indicates whether to enable analysis for closed loop hydronic piping networks in the background. Fabrication API additionsHanger Rod additions The following new methods and properties allow better control of hanger rod lengths: * FabricationRodInfo.GetRodStructureExtension() * FabricationRodInfo.SetRodStructureExtension() – Sets the extension of the rod into the structure. The rod will remain hosted by structure and have the extension applied on top of any calculated length. This method is only valid for rods which are already hosted by structure. * FabricationRodInfo.CanRodsBeHosted – Setting this to false disassociates the hanger from any structure and allows the user to manually set lengths. Setting it to true re-enables rods automatically hosting to structure again. * FabricationRodInfo.GetRodLength() – Gets the current rod length for the specified rod index (including any extension), whether it is hosted or not. * FabricationRodInfo.SetRodLength() – Sets the current rod length for the specified rod index – but only if hosting is disabled by setting CanRodsBeHosted = false first. The new property: * FabricationPart.HangerRodKit allows users to get or set the support rod kit override. This gives the user better control over hanger rod thicknesses. Placing and splitting fabrication parts The following methods allow placing and splitting fabrication parts: * FabricationPart.AlignPartByConnectorToConnector() – Aligns a part by its connector to another connector. * FabricationPart.AlignPartByInsertionPoint() – Aligns the part by its insertion point to a point and rotation in free space. * FabricationPart.AlignPartByConnector() – Aligns the part by its connector to a point and rotation in free space. * FabricationPart.AlignPartByInsertionPointAndCutInToStraight() – Aligns the part by its insertion point to a point and rotation in on a straight. * FabricationPart.HasNoConnections() – Checks to see if all the part's connectors are open. * FabricationPart.CanSplitStraight() – Checks to see if a straight can be split into two at a given position. * FabricationPart.SplitStraight() – Splits a straight at a given position. Fabrication Part export additions The new method: * Autodesk.Revit.DB.Fabrication.FabricationUtils.ExportToPCF() exports Fabrication parts to PCF format. The new property: * FabricationPart.SpoolName allows control over Spool names in PCF output. Fabrication Part status additions Two properties were added to FabricationPart to allow the user to query and set the part fabrication status field: * FabricationPart.PartStatus – Queries or changes the part fabrication status field current value. Setting the value will track when it was changed. * FabricationPart.PartGuid – Queries the part's fabrication globally unique identifier, as used in applications such as Tracker. Fabrication part comparison The new method: * FabricationPart.IsSameAs() compares basic dimensional information of two fabrication parts but also allows the user to specify additional fabrication data to ignore. This allows users to compare parts including fabrication data not exposed in Revit. Fabrication Part ancillary usage additions The new method: * FabricationPart.GetPartAncillaryUsage() gets a list of FabricationAncillaryUsage structures that lists the ancillaries that the fabrication part uses. This method can be used to populate cut lists and procure ancillaries needed to fabricate and install the fabrication part. The new class: * FabricationAncillaryUsage contains the ancillary usage data. It has the following read-only properties: * FabricationAncillaryUsage.Type – A new enumerated type FabricationAncillaryType which describes what kind of ancillary it is (eg. a fixing, airturn vane or support material). * FabricationAncillaryUsage.UsageType – a new enumerated type FabricationAncillaryUsageType describing the usage of the ancillary (eg. in a support, connector or airturn). * FabricationAncillaryUsage.AncillaryId – the ancillary database identifier as listed by FabricationConfiguration.GetAncillaries(). * FabricationAncillaryUsage.Length * FabricationAncillaryUsage.AncillaryWidthOrDiameter – The width / diameter of the ancillary (eg. rod thickness). * FabricationAncillaryUsage.AncillaryDepth * FabricationAncillaryUsage.Quantity * FabricationAncillaryUsage.ProductCode Fabrication Part custom data additions The following methods allow access to Fabrication Part custom data defined per part. This can be used for querying and changing values: * FabricationPart.HasCustomData() – Queries if a part has a certain optional custom data. * FabricationPart.Get/SetPartCustomDataText/Integer/Real() – Gets or sets the fabrication part's custom data. * FabricationPart.Add/RemovePartCustomData() – Adds or removes optional custom data on fabrication parts. FabricationConfiguration additions New methods have been added to access fabrication data defined by the currently loaded fabrication configuration. These can be used to query what fabrication data is available for fabrication parts to use: * FabricationConfiguration.GetAllDampers() * FabricationConfiguration.GetDamperName() * FabricationConfiguration.GetAncillaries() – list all ancillary identifiers (by enumerated type) * FabricationConfiguration.GetAncillaryName() * FabricationConfiguration.GetAllPartStatuses() * FabricationConfiguration.GetPartStatusDescription() * FabricationConfiguration.GetAllPartCustomData() * FabricationConfiguration.GetPartCustomDataName() * FabricationConfiguration.GetPartCustomDataType() Routing exclusions additions The following methods allow users to override routing exclusions: * FabricationService.IsGroupExcluded() – Gets whether a service group is excluded from routing. * FabricationService.SetServiceGroupExclusions() – Sets the service group exclusions. * FabricationService.ResetServiceExclusionOverrides() – Resets the overridden service group and button exclusions back to default. * FabricationService.OverrideServiceButtonExclusion() – Overrides the default service button exclusions. * FabricationServiceButton.IsExcluded() – Gets if the service button is excluded from routing. FabricationServiceButton addition The new property: * FabricationServiceButton.IsStraight returns true if all conditions of the fabrication service button are straight pieces. This indicates the button is suitable for use with multi-point routing, among other uses. ### Python Automatic HTML Heading Numbering Script The following Python script [number_html_headings.py](zip/number_html_headings.py) automatically adds HTML hypertext reference `A` tags to an HTML file sequentially numbering up to ten levels of headings: ``` # !/usr/bin/python # # number_html_headings.py - add numbering to HTML headings # # Copyright (C) 2017-04-25 by Jeremy Tammik, Autodesk Inc. # filename = 'Revit_Platform_API_Changes_and_Additions_2018_03.htm' filepath = '/a/doc/revit/tbc/git/a/zip/' + filename nlevels = 10 # max heading level to number ih = [] # current count for each heading level for i in range(nlevels): ih.append(0) def filereadlines( filename ): f = open( filename ) data = f.readlines() f.close() return data if __name__ == '__main__': def main(): lines = filereadlines( filepath ) for line in lines: line = line.strip() a = '' if line.startswith('' print a + line main() ``` I used it to generate the [table of contents](#1) above. It handles up to ten heading levels `H1`..`H9` and assumes the heading tags are all at the beginning of a line. I implemented it for and tested it on the [input file `Revit_Platform_API_Changes_and_Additions_2018_03.htm`](zip/Revit_Platform_API_Changes_and_Additions_2018_03.htm), generating the [output file `Revit_Platform_API_Changes_and_Additions_2018_04.htm`](zip/Revit_Platform_API_Changes_and_Additions_2018_04.htm). It will gladden me if you can make use of this as well.
---

## Related Sections
- [API Changes - What's New in the Revit 2018 API](./1551-01_whats_new_in_the_revit_2018_api.md)
- [API Changes - Table of Contents](./1551-02_table_of_contents.md)
- [API Changes - API Changes](./1551-03_api_changes.md)
- [API Changes - Element modifications and contextual commands](./1551-04_element_modifications_and_contextual_commands.md)
- [API Changes - External commands and applications](./1551-05_external_commands_and_applications.md)
- [API Changes - References and selection of subelements](./1551-06_references_and_selection_of_subelements.md)
- [API Changes - Classes](./1551-07_classes.md)
- [API Changes - Methods](./1551-08_methods.md)
- [API Changes - Properties](./1551-09_properties.md)
- [API Changes - Enumerated types](./1551-10_enumerated_types.md)
- [API Changes - API Additions](./1551-11_api_additions.md)
- [API Changes - Railings API additions related to MultistoryStairs](./1551-12_railings_api_additions_related_to_multistorystairs.md)
- [API Changes - DimensionEqualityLabelFormating API](./1551-13_dimensionequalitylabelformating_api.md)
- [API Changes - UnitsFormatOptions in DimensionType](./1551-14_unitsformatoptions_in_dimensiontype.md)
- [API Changes - OrdinateDimensionSetting](./1551-15_ordinatedimensionsetting.md)
- [API Changes - Surface and Face API](./1551-16_surface_and_face_api.md)
- [API Changes - RevolvedSurface API](./1551-17_revolvedsurface_api.md)
- [API Changes - RuledSurface API](./1551-18_ruledsurface_api.md)
- [API Changes - View update for DirectContext3D](./1551-19_view_update_for_directcontext3d.md)
- [API Changes - Acquire and Publish coordinates API additions](./1551-20_acquire_and_publish_coordinates_api_additions.md)
- [API Changes - SiteLocation API additions](./1551-21_sitelocation_api_additions.md)
- [API Changes - ProjectLocation API additions](./1551-22_projectlocation_api_additions.md)
